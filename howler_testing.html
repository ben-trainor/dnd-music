<!doctype html>
<html lang="en">

    <head>
        <title>HowlerJS Testing</title>
        <!-- Required meta tags -->
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

        <!-- Bootstrap CSS v5.0.2 -->
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"  integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
        <link rel="stylesheet" href="css/main.css" />
        <script src="node_modules/howler/dist/howler.js"></script>

        <script>

            /*

                Get buttons with class music-button
                Set onlick function to musicLogic()
                    musicLogic() plays particular sound

            */

            
            window.onload = function() { // Have to wait for page to load before running anything


                // Initialize song objects and store them in the parent object
                var howlerObjectsHolder = {};
                var holderIndex = 0;
                var pizza = new Howl({
                    src: ['../audio/music/1 in the end, we all became pizza and ate ourselves.mp3'],
                    name: "pizza"
                }); howlerObjectsHolder[holderIndex++] = pizza;
                var paul = new Howl({
                    src: ['../audio/music/2 yeah no paul looks like this.mp3'],
                    name: "paul"
                }); howlerObjectsHolder[holderIndex++] = paul;
                var tasting = new Howl({
                    src: ['../audio/music/3 tasting flowers.mp3'],
                    name: "tasting"
                }); howlerObjectsHolder[holderIndex++] = tasting;
                var hours = new Howl({
                    src: ['../audio/music/4 only mark the bright hours.mp3'],
                    name: "hours"
                }); howlerObjectsHolder[holderIndex++] = hours;
                var igloo = new Howl({
                    src: ['../audio/music/5 an igloo, perhaps.mp3'],
                    name: "igloo"
                }); howlerObjectsHolder[holderIndex++] = igloo;
                var willow = new Howl({
                    src: ['../audio/music/6 wandering willow.mp3'],
                    name: "willow"
                }); howlerObjectsHolder[holderIndex++] = willow;
                var sun = new Howl({
                    src: ['../audio/music/7 we haven\'t seen the sun for three days.mp3'],
                    name: "sun"
                }); howlerObjectsHolder[holderIndex++] = sun;
                var happenings = new Howl({
                    src: ['../audio/music/8 places, things, and happenings.mp3'],
                    name: "happenings"
                }); howlerObjectsHolder[holderIndex++] = happenings;


                
                // Make a collection of all the buttons with the "music-button" class
                var musicButtons =  document.getElementsByClassName("music-button");
                var songIDs = Array; // Note: JavaScript Arrays are mutable
                var currentSong = {};
                var songIsPlaying = false;

                storeButtonSongs();
                setButtonSongs();

                // Store button IDs
                function storeButtonSongs() {
                    // Loop through both array and collection to read and store
                    for (let i = 0; i < musicButtons.length; i++) {
                        songIDs[i] = musicButtons.item(i).id.toString();
                        // console.log("Storing " + songIDs[i]);
                    }
                }

                function setButtonSongs() {
                    for (let i = 0; i < musicButtons.length; i++) {
                        // console.log("Creating onclick listener for " + songIDs[i]);
                        musicButtons.item(i).addEventListener("click", function() {
                            musicLogic(this.id);
                        });
                    }
                }


                // START WITH MAIN MUSIC LOGIC FUNCTION
                function musicLogic(id) {
                    console.log("ID found: " + id);

                    for (var i = 0; i < songIDs.length; i++) {

                    }
                    
                    switch (id) {
                        case "pizza":
                            tryToPlay(pizza);
                            break;
                        case "paul": 
                            tryToPlay(paul);
                            break;
                        case "tasting": 
                            tryToPlay(tasting);
                            break;
                        case "hours": 
                            tryToPlay(hours);
                            break;
                        case "igloo": 
                            tryToPlay(igloo);
                            break;
                        case "willow": 
                            tryToPlay(willow);
                            break;
                        case "sun": 
                            tryToPlay(sun);
                            break;
                        case "happenings": 
                            tryToPlay(happenings);
                            break;
                        case "stop":
                            stopSong(currentSong);
                            break;
                    }
                }

                function tryToPlay(howlerObj) {
                    if (songIsPlaying == false) {
                        howlerObj.play();
                        currentSong = howlerObj;
                        songIsPlaying = true;
                    }
                    else {
                        console.log("Song is already playing");
                    }
                }
                
                function stopSong(howlerObj) {
                    howlerObj.stop();
                    songIsPlaying = false;
                }

            }


        </script>

    </head>

    <body>
        
        <ul class="list-group-flush m-0 p-0">
            <li class="list-group-item"><button id="pizza" class="btn btn-lg btn-dark music-button">in the end, we all became pizza and ate ourselves</button></li>
            <li class="list-group-item"><button id="paul" class="btn btn-lg btn-dark music-button">yeah no paul looks like this</button></li>
            <li class="list-group-item"><button id="tasting" class="btn btn-lg btn-dark music-button">tasting flowers</button></li>
            <li class="list-group-item"><button id="hours" class="btn btn-lg btn-dark music-button">only mark the bright hours</button></li>
            <li class="list-group-item"><button id="igloo" class="btn btn-lg btn-dark music-button">an igloo, perhaps</button></li>
            <li class="list-group-item"><button id="willow" class="btn btn-lg btn-dark music-button">wandering willow</button></li>
            <li class="list-group-item"><button id="sun" class="btn btn-lg btn-dark music-button">we haven't seen the sun for three days</button></li>
            <li class="list-group-item"><button id="happenings" class="btn btn-lg btn-dark music-button">places, things, and happenings</button></li>
            <li class="list-group-item"><button id="stop" class="btn btn-lg btn-dark music-button">Stop All</button></li>
        </ul>
        
        
        
        <!-- Bootstrap JavaScript Libraries -->
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js" integrity="sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js" integrity="sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF" crossorigin="anonymous"></script>

    </body>

</html>